#!/bin/bash
# Quick QA Workflow for MA Crossover Baseline EA v1.0
# This script provides a step-by-step checklist for controlled testing

echo "======================================================================"
echo "  MA Crossover Baseline EA v1.0 - QA Workflow Checklist"
echo "======================================================================"
echo ""

# Color codes for readability
GREEN='\033[0;32m'
BLUE='\033[0;34m'
YELLOW='\033[1;33m'
NC='\033[0m' # No Color

echo -e "${BLUE}üìã PHASE 1: PURE MA BASELINE (Deterministic)${NC}"
echo "--------------------------------------------------------------------"
echo "Goal: Establish repeatable performance floor"
echo ""
echo "1. Compilation:"
echo "   ‚ñ° Open MetaEditor"
echo "   ‚ñ° Compile TickPhysics_Crypto_SelfHealing_Crossover_EA_v1_0.mq5"
echo "   ‚ñ° Verify no errors"
echo ""
echo "2. Backtest Setup (Strategy Tester):"
echo "   ‚ñ° Symbol: ETHUSD (or your preferred crypto pair)"
echo "   ‚ñ° Timeframe: M5"
echo "   ‚ñ° Date Range: 3 months (e.g., 2024-10-01 to 2025-01-01)"
echo "   ‚ñ° Model: Every tick"
echo ""
echo "3. Input Parameters (Phase 1):"
echo "   ‚ñ° InpUsePhysics = false"
echo "   ‚ñ° InpUseSelfHealing = false"
echo "   ‚ñ° InpUseMAEntry = true"
echo "   ‚ñ° InpUseMAExit = true"
echo "   ‚ñ° InpMAFast_Entry = 25"
echo "   ‚ñ° InpMASlow_Entry = 100"
echo "   ‚ñ° InpMAFast_Exit = 25"
echo "   ‚ñ° InpMASlow_Exit = 50"
echo "   ‚ñ° InpEnableSignalLog = true"
echo "   ‚ñ° InpEnableTradeLog = true"
echo "   ‚ñ° InpSignalLogFile = \"TP_Crypto_Signals_Baseline.csv\""
echo "   ‚ñ° InpTradeLogFile = \"TP_Crypto_Trades_Baseline.csv\""
echo ""
echo "4. Run Backtest:"
echo "   ‚ñ° Start backtest"
echo "   ‚ñ° Monitor Experts log for MA crossover signals"
echo "   ‚ñ° Verify trades executed"
echo "   ‚ñ° Wait for completion"
echo ""
echo "5. Verify CSV Output:"
echo "   ‚ñ° Navigate to MT5 Files folder:"
echo "     C:\\Users\\<YourName>\\AppData\\Roaming\\MetaQuotes\\Terminal\\<ID>\\MQL5\\Files\\"
echo "   ‚ñ° Check TP_Crypto_Signals_Baseline.csv exists"
echo "   ‚ñ° Check TP_Crypto_Trades_Baseline.csv exists"
echo "   ‚ñ° Open CSVs in Excel/text editor to verify data"
echo ""
echo "6. Python Analysis:"
echo "   ‚ñ° Copy CSVs to /Users/patjohnston/ai-trading-platform/MQL5/"
echo "   ‚ñ° Run: python analyze_backtest.py --trades TP_Crypto_Trades_Baseline.csv"
echo "   ‚ñ° Run: python dashboard.py"
echo "   ‚ñ° Document baseline metrics (win rate, profit factor, max DD)"
echo ""
echo "7. Repeatability Test:"
echo "   ‚ñ° Re-run backtest with same settings"
echo "   ‚ñ° Compare CSVs: should be IDENTICAL"
echo "   ‚ñ° Confirm deterministic behavior"
echo ""
echo -e "${GREEN}‚úÖ Phase 1 Complete: Baseline Established${NC}"
echo ""
echo ""

echo -e "${BLUE}üìã PHASE 2: MA + PHYSICS ENHANCEMENT (Compare)${NC}"
echo "--------------------------------------------------------------------"
echo "Goal: Measure impact of physics filters"
echo ""
echo "1. Input Parameters (Phase 2):"
echo "   ‚ñ° InpUsePhysics = true         ‚Üê CHANGED"
echo "   ‚ñ° InpUseSelfHealing = false"
echo "   ‚ñ° InpUseMAEntry = true"
echo "   ‚ñ° InpUseMAExit = true"
echo "   ‚ñ° InpSignalLogFile = \"TP_Crypto_Signals_Physics.csv\"  ‚Üê CHANGED"
echo "   ‚ñ° InpTradeLogFile = \"TP_Crypto_Trades_Physics.csv\"    ‚Üê CHANGED"
echo "   ‚ñ° Keep all other parameters same as Phase 1"
echo ""
echo "2. Indicator Setup (if using):"
echo "   ‚ñ° Compile TickPhysics_Crypto_Indicator_v2_1.mq5"
echo "   ‚ñ° Verify InpUseTickPhysicsIndicator = true"
echo "   ‚ñ° OR set InpUseTickPhysicsIndicator = false to skip indicator"
echo ""
echo "3. Run Backtest:"
echo "   ‚ñ° Use SAME date range as Phase 1"
echo "   ‚ñ° Use SAME symbol and timeframe"
echo "   ‚ñ° Start backtest"
echo "   ‚ñ° Expect FEWER trades (physics filters reduce signals)"
echo ""
echo "4. Python Analysis & Comparison:"
echo "   ‚ñ° Run: python analyze_backtest.py --trades TP_Crypto_Trades_Physics.csv"
echo "   ‚ñ° Compare to Phase 1 metrics:"
echo "     - Win Rate: Should improve"
echo "     - Max Drawdown: Should reduce"
echo "     - Profit Factor: Should improve"
echo "     - Total Trades: Should decrease"
echo "   ‚ñ° Document improvements (or lack thereof)"
echo ""
echo -e "${GREEN}‚úÖ Phase 2 Complete: Physics Impact Measured${NC}"
echo ""
echo ""

echo -e "${BLUE}üìã PHASE 3: MA + PHYSICS + LEARNING (Advanced)${NC}"
echo "--------------------------------------------------------------------"
echo "Goal: Measure adaptive learning effectiveness"
echo ""
echo "1. Input Parameters (Phase 3):"
echo "   ‚ñ° InpUsePhysics = true"
echo "   ‚ñ° InpUseSelfHealing = true      ‚Üê CHANGED"
echo "   ‚ñ° InpEnableLearning = true      ‚Üê CHANGED"
echo "   ‚ñ° InpLearningFile = \"TP_Learning_v22.json\""
echo "   ‚ñ° InpSignalLogFile = \"TP_Crypto_Signals_Learning.csv\"  ‚Üê CHANGED"
echo "   ‚ñ° InpTradeLogFile = \"TP_Crypto_Trades_Learning.csv\"    ‚Üê CHANGED"
echo "   ‚ñ° Keep all other parameters same as Phase 2"
echo ""
echo "2. Run Backtest:"
echo "   ‚ñ° Use SAME date range as Phase 1 & 2"
echo "   ‚ñ° Monitor learning state updates (JSON file)"
echo "   ‚ñ° Expect NON-DETERMINISTIC behavior (parameters adapt)"
echo ""
echo "3. Python Analysis & Comparison:"
echo "   ‚ñ° Run: python analyze_backtest.py --trades TP_Crypto_Trades_Learning.csv"
echo "   ‚ñ° Compare to Phase 1 & 2:"
echo "     - Does learning improve win rate?"
echo "     - Does it adapt to regime changes?"
echo "     - Is it robust or overfitted?"
echo "   ‚ñ° Document learning effectiveness"
echo ""
echo -e "${GREEN}‚úÖ Phase 3 Complete: Learning Impact Measured${NC}"
echo ""
echo ""

echo -e "${YELLOW}üìä FINAL COMPARISON MATRIX${NC}"
echo "--------------------------------------------------------------------"
echo "Metric                | Baseline | Physics | Learning"
echo "----------------------|----------|---------|----------"
echo "Win Rate (%)          |   ___    |   ___   |   ___"
echo "Profit Factor         |   ___    |   ___   |   ___"
echo "Max Drawdown (%)      |   ___    |   ___   |   ___"
echo "Total Trades          |   ___    |   ___   |   ___"
echo "Avg Trade Duration    |   ___    |   ___   |   ___"
echo "Repeatability         | ‚úÖ 100%  | ‚úÖ 100% | ‚ùå N/A"
echo ""
echo "Recommendation:"
echo "‚ñ° Use Baseline if: You want predictable, simple strategy"
echo "‚ñ° Use Physics if: You want better quality, fewer false signals"
echo "‚ñ° Use Learning if: You want adaptive optimization (advanced)"
echo ""
echo ""

echo -e "${BLUE}üõ†Ô∏è TROUBLESHOOTING${NC}"
echo "--------------------------------------------------------------------"
echo "Issue: CSV logs not created"
echo "  ‚Üí Check InpEnableSignalLog = true and InpEnableTradeLog = true"
echo "  ‚Üí Verify file paths in inputs"
echo "  ‚Üí Check MT5 Files folder permissions"
echo ""
echo "Issue: No trades generated"
echo "  ‚Üí Verify MA crossover occurs in data (check chart manually)"
echo "  ‚Üí Lower physics filter thresholds (if enabled)"
echo "  ‚Üí Check Experts log for errors"
echo ""
echo "Issue: Indicator not found"
echo "  ‚Üí Compile TickPhysics_Crypto_Indicator_v2_1.mq5"
echo "  ‚Üí OR set InpUseTickPhysicsIndicator = false"
echo ""
echo "Issue: Python scripts fail"
echo "  ‚Üí Check CSV file paths"
echo "  ‚Üí Install dependencies: pip install pandas matplotlib numpy"
echo "  ‚Üí Verify CSV headers match expected format"
echo ""
echo ""

echo -e "${GREEN}======================================================================"
echo "  QA Workflow Ready - Start with Phase 1!"
echo "======================================================================${NC}"
echo ""
echo "For detailed documentation, see:"
echo "  - MA_CROSSOVER_BASELINE_v1_0_SUMMARY.md"
echo "  - QA_GUIDE.md"
echo "  - BUGFIX_SUMMARY_v2_*.md"
echo ""
